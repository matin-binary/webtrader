define(["exports","jquery","../common/util","jquery-growl"],function(e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.refreshMenu=e.extractChartableMarkets=e.extractFilteredMarkets=void 0;var n,o=(n=t)&&n.__esModule?n:{default:n};var r={trade:".trade a",instruments:".instruments a",assetIndex:".assetIndex",tradingTimes:".tradingTimes"},a=function(){return"Trading options isnâ€™t possible in your country.".i18n()},i=e.extractFilteredMarkets=function(e,r){if(e)return e.trading_times.markets.map(function(e){var t={name:e.name,display_name:e.name};return t.submarkets=e.submarkets.map(function(e){var t={name:e.name,display_name:e.name},n=e.symbols;return r&&r.filter&&(n=n.filter(r.filter)),t.instruments=n.map(function(e){return{symbol:e.symbol,display_name:e.name,delay_amount:e.delay_amount||0,events:e.events,times:e.times,settlement:e.settlement,feed_license:e.feed_license||"realtime"}}),t}).filter(function(e){return 0<e.instruments.length}),t})},s=e.extractChartableMarkets=function(e){return i(e,{filter:function(e){return"chartonly"!==e.feed_license}})||[]},u=e.refreshMenu=function(s,e,u){var n=void 0;0==e.length?(Object.values(r).map(function(e){return(0,o.default)(e).addClass("disabled")}),o.default.growl.error({message:a()})):3==e.length?o.default.growl.error({message:a()}):Object.values(r).map(function(e){return(0,o.default)(e).removeClass("disabled")});var t="<ul>"+e.map(function(e){return"<li><div>"+e.display_name+"</div><ul>"+e.submarkets.map(function(e){return(e.subgroup!==n&&"none"!==e.subgroup?"<div class='subgroup'>"+(t=e.subgroup,n=t,e.subgroup_name)+"</div>":"")+"<li><div>"+e.display_name+"</div><ul>"+e.instruments.map(function(e){return"<li symbol='"+e.symbol+"' pip='"+e.pip+"'><div>"+e.display_name+"</div></li>"}).join("")+"</ul></li>";var t}).join("")+"</ul></li>"}).join("")+"</ul>",l=(0,o.default)(t);s.find("> ul").menu("destroy").remove(),s.append(l),l.find("li[symbol]").on("click",function(e,t){var n=(0,o.default)(e.target).text(),r=(0,o.default)(e.target).closest("li"),a=r.attr("symbol"),i=r.attr("pip");l.detach(),s.append(l),u(a,n,i)}),l.menu({position:{collision:"fit"}})};e.default={extractChartableMarkets:s,extractFilteredMarkets:i,refreshMenu:u}});